<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="css/leaflet.css">
        <link rel="stylesheet" href="css/qgis2web.css">
        <link rel="stylesheet" href="css/Control.OSMGeocoder.css">
        <link rel="stylesheet" href="css/leaflet.groupedlayercontrol.css" />
        <link rel="stylesheet" href="css/L.Control.Window.css" />
        <link rel="stylesheet" href="css/leaflet-control-credits.css" />
        
        <style>
        html, body, #map {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
        </style>
        <title></title>
    </head>
    <body>
        <div id="map">
         
        <!--<div id="logoContainer"><img src="images/logo.jpg"/>-->
        <script src="js/qgis2web_expressions.js"></script>
        <script src="js/leaflet.js"></script>
        <script src="js/leaflet-heat.js"></script>
        <script src="js/leaflet.rotatedMarker.js"></script>
        <script src="js/leaflet.pattern.js"></script>
        <script src="js/leaflet-hash.js"></script>
        <script src="js/Autolinker.min.js"></script>
        <script src="js/rbush.min.js"></script>
        <script src="js/labelgun.min.js"></script>
        <script src="js/labels.js"></script>
        <script src="js/Control.OSMGeocoder.js"></script>
        <script src="js/leaflet.groupedlayercontrol.js"></script>
        <script src="data/req_1.js"></script>
        <script src="data/off_2.js"></script>
        <script src="data/line_diss_1.js"></script>
        <script src="js/L.Control.Window.js"></script>
        <script src="js/leaflet-control-credits.js"></script>
        <script>
        
        
        
        var map = L.map('map', {
            zoom: 11,
            zoomControl:true, maxZoom:14, minZoom:7
        }).fitBounds([[30.703770010157015,33.63006277496208],[32.62926996243004,36.27873436829616]]);
        var hash = new L.Hash(map);
        
        
        var MassuotIcon = L.icon({
            iconUrl: 'logo1.png',
            iconSize:     [80, 100], // size of the icon   
            iconAnchor:   [22, 94], //[22, 94] point of the icon which will correspond to marker's location            
        });
        var Massuot =L.marker([31.70245,34.68910], {icon: MassuotIcon});//34.68909,31.70245
        
        
        map.attributionControl.addAttribution('<a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a>');
        
        var bounds_group = new L.featureGroup([]);
        function setBounds() {
        }
        var overlay_DarkMatterretina_0 = L.tileLayer('http://a.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}@2x.png', {
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
            opacity: 1.0
        });
        overlay_DarkMatterretina_0.addTo(map);
        map.addLayer(overlay_DarkMatterretina_0);
        
        var OpenStreetMap_Mapnik = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        });
        

        map.createPane('pane_req_1');
        map.getPane('pane_req_1').style.zIndex = 401;
        map.getPane('pane_req_1').style['mix-blend-mode'] = 'normal';
        var req_1_hm = geoJson2heat(json_req_1,
                                      '');
        var layer_req_1 = new L.heatLayer(req_1_hm, {
            attribution: '',
            radius: 25,
            max: 1,
            minOpacity: 0.5,
            blur: 90,
            gradient:{0.4: '#ffb3b3',0.5: '#ff6666', 0.65: 'red', 1:'#661400' }});
            //gradient: {0: '#000004', 0.0196078: '#02020b', 0.0392157: '#050416', 0.0588235: '#090720', 0.0784314: '#0e0b2b', 0.0980392: '#140e36', 0.117647: '#1a1042', 0.137255: '#21114e', 0.156863: '#29115a', 0.176471: '#311165', 0.196078: '#390f6e', 0.215686: '#420f75', 0.235294: '#4a1079', 0.254902: '#52137c', 0.27451: '#5a167e', 0.294118: '#621980', 0.313725: '#6a1c81', 0.333333: '#721f81', 0.352941: '#792282', 0.372549: '#812581', 0.392157: '#892881', 0.411765: '#912b81', 0.431373: '#992d80', 0.45098: '#a1307e', 0.470588: '#aa337d', 0.490196: '#b2357b', 0.509804: '#ba3878', 0.529412: '#c23b75', 0.54902: '#ca3e72', 0.568627: '#d2426f', 0.588235: '#d9466b', 0.607843: '#e04c67', 0.627451: '#e75263', 0.647059: '#ec5860', 0.666667: '#f1605d', 0.686275: '#f4695c', 0.705882: '#f7725c', 0.72549: '#f97b5d', 0.745098: '#fb8560', 0.764706: '#fc8e64', 0.784314: '#fd9869', 0.803922: '#fea16e', 0.823529: '#feaa74', 0.843137: '#feb47b', 0.862745: '#febd82', 0.882353: '#fec68a', 0.901961: '#fecf92', 0.921569: '#fed89a', 0.941176: '#fde2a3', 0.960784: '#fdebac', 0.980392: '#fcf4b6', 1: '#fcfdbf'}});
        bounds_group.addLayer(layer_req_1);
        map.addLayer(layer_req_1);
        

        map.createPane('pane_off_2');
        map.getPane('pane_off_2').style.zIndex = 402;
        map.getPane('pane_off_2').style['mix-blend-mode'] = 'normal';
        var off_2_hm = geoJson2heat(json_off_2,
                                      '');
        var layer_off_2 = new L.heatLayer(off_2_hm, {
            attribution: '',
            radius: 25,
            max: 1,
            minOpacity: 0.5,
            blur: 90,
            gradient:{0.3: ' #e6e6ff' ,0.65: '#0000ff', 1: '#000080'}});
            //gradient: {0: '#440154', 0.0196078: '#46085c', 0.0392157: '#471063', 0.0588235: '#481769', 0.0784314: '#481d6f', 0.0980392: '#482475', 0.117647: '#472a7a', 0.137255: '#46307e', 0.156863: '#453781', 0.176471: '#433d84', 0.196078: '#414287', 0.215686: '#3f4889', 0.235294: '#3d4e8a', 0.254902: '#3a538b', 0.27451: '#38598c', 0.294118: '#355e8d', 0.313725: '#33638d', 0.333333: '#31688e', 0.352941: '#2e6d8e', 0.372549: '#2c718e', 0.392157: '#2a768e', 0.411765: '#297b8e', 0.431373: '#27808e', 0.45098: '#25848e', 0.470588: '#23898e', 0.490196: '#218e8d', 0.509804: '#20928c', 0.529412: '#1f978b', 0.54902: '#1e9c89', 0.568627: '#1fa188', 0.588235: '#21a585', 0.607843: '#24aa83', 0.627451: '#28ae80', 0.647059: '#2eb37c', 0.666667: '#35b779', 0.686275: '#3dbc74', 0.705882: '#46c06f', 0.72549: '#50c46a', 0.745098: '#5ac864', 0.764706: '#65cb5e', 0.784314: '#70cf57', 0.803922: '#7cd250', 0.823529: '#89d548', 0.843137: '#95d840', 0.862745: '#a2da37', 0.882353: '#b0dd2f', 0.901961: '#bddf26', 0.921569: '#cae11f', 0.941176: '#d8e219', 0.960784: '#e5e419', 0.980392: '#f1e51d', 1: '#fde725'}});
        bounds_group.addLayer(layer_off_2);
        //map.addLayer(layer_off_2);
        
        setBounds();
        function geoJson2heat(geojson, weight) {
          return geojson.features.map(function(feature) {
            return [
              feature.geometry.coordinates[1],
              feature.geometry.coordinates[0],
              feature.properties[weight]
            ];
          });
        }
        map.createPane('pane_line_diss_1');
        map.getPane('pane_line_diss_1').style.zIndex = 403;
        map.getPane('pane_line_diss_1').style['mix-blend-mode'] = 'normal';
        var layer_line_diss_1 = new L.geoJson(json_line_diss_1, {
            attribution: '<a href=""></a>',
            pane: 'pane_line_diss_1',
            //onEachFeature: pop_line_diss_1,
            style: {
                pane: 'pane_line_diss_1',
                opacity: 1,
                color: 'rgb(113, 244, 66)',
                dashArray: '',
                lineCap: 'square',
                lineJoin: 'bevel',
                weight: 1,
                fillOpacity: 0,
            }
        });
        bounds_group.addLayer(layer_line_diss_1);
        //map.addLayer(layer_line_diss_1);
        
        //var req = L.layerGroup([layer_req_1]);
        //var off = L.layerGroup([layer_off_2]);
        var kav = L.layerGroup([layer_line_diss_1]);
        var baseMaps = {
            "מפת רקע שחורה": overlay_DarkMatterretina_0,
            "מפת רחובות": OpenStreetMap_Mapnik
        };
        
        
        //L.control.layers( baseMaps,overlayMaps).addTo(map);
        var mapControlsContainer = document.getElementsByClassName("leaflet-control")[0];
        
        
        
        //var logoContainer = document.getElementById("logoContainer");

        //mapControlsContainer.appendChild(logoContainer);
        
        var groupedOverlays = {
          "מפות חום": {
            "בקשות טרמפים": layer_req_1,
            "הצעות טרמפים":layer_off_2,
          },
          "שכבות נוספות": {
            "משואות יצחק":Massuot,
            "שכבת קישוריות":kav
            
          }
        };
        var options = {
      // Make the "Landmarks" group exclusive (use radio inputs)
      exclusiveGroups: ["מפות חום"],
      // Show a checkbox next to non-exclusive group labels for toggling all
      groupCheckboxes: true
        };
        var layerControl = L.control.groupedLayers(baseMaps, groupedOverlays, options);
        map.addControl(layerControl);
        
        var s ='הצגה ויזואלית של קבוצת הטרמפים של משואות יצחק. ניתן לצפות בפיזור ובצפיפות של בקשות טרמפים/ הצעות טרמפים. למען הסר ספק אין במפה מידע אישי אודות מציעי/מבקשי הטרמפים. ' 
        var p='\n\n לפרטים נוספים על אופן הכנת המפה \n\n'
        
        //var result = p.link("http://geoint.co.il");
        var result =('<a href="http://geoint.co.il" target="_blank">\n\n לפרטים נוספים על אופן הכנת המפה \n\n</a>')
       
        var win =  L.control.window(map,{title:'מיפוי קבוצת ווטסאפ',content:s+result}).show()
           
        var credctrl = L.controlCredits({
            image: "images/logo.jpg",
            link: "http://www.geoint.co.il/",
            text: "לפרטים נוספים <br/>http://geoint.co.il<br/> יהודה הורן",
            width: 50,
            height: 50
        }).addTo(map);
        </script>
    </body>
</html>
